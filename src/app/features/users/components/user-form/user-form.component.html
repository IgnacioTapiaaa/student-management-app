<mat-card>
  <mat-card-header>
    <mat-card-title>{{ formTitle }}</mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
      <!-- Email Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Email</mat-label>
        <input
          matInput
          type="email"
          formControlName="email"
          placeholder="user&#64;example.com"
        />
        <mat-icon matPrefix>email</mat-icon>
        <mat-error>{{ getErrorMessage('email') }}</mat-error>
      </mat-form-field>

      <!-- First Name Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>First Name</mat-label>
        <input
          matInput
          type="text"
          formControlName="firstName"
          placeholder="Enter first name"
        />
        <mat-icon matPrefix>person</mat-icon>
        <mat-error>{{ getErrorMessage('firstName') }}</mat-error>
      </mat-form-field>

      <!-- Last Name Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Last Name</mat-label>
        <input
          matInput
          type="text"
          formControlName="lastName"
          placeholder="Enter last name"
        />
        <mat-icon matPrefix>person_outline</mat-icon>
        <mat-error>{{ getErrorMessage('lastName') }}</mat-error>
      </mat-form-field>

      <!-- Role Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Role</mat-label>
        <mat-select formControlName="role">
          <mat-option *ngFor="let role of roles" [value]="role.value">
            {{ role.label }}
          </mat-option>
        </mat-select>
        <mat-icon matPrefix>admin_panel_settings</mat-icon>
        <mat-error>{{ getErrorMessage('role') }}</mat-error>
      </mat-form-field>

      <!-- Change Password Checkbox (Edit Mode Only) -->
      <div *ngIf="isEditMode" class="change-password-section">
        <mat-checkbox
          formControlName="changePassword"
          (change)="onChangePasswordToggle()">
          Change Password
        </mat-checkbox>
      </div>

      <!-- Password Field (Create Mode or Change Password in Edit Mode) -->
      <mat-form-field
        *ngIf="!isEditMode || showChangePassword()"
        appearance="outline"
        class="full-width">
        <mat-label>Password</mat-label>
        <input
          matInput
          [type]="hidePassword() ? 'password' : 'text'"
          formControlName="password"
          placeholder="Enter password (min 6 characters)"
        />
        <mat-icon matPrefix>lock</mat-icon>
        <button
          mat-icon-button
          matSuffix
          type="button"
          (click)="togglePasswordVisibility()"
          [attr.aria-label]="'Toggle password visibility'">
          <mat-icon>{{ hidePassword() ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        <mat-error>{{ getErrorMessage('password') }}</mat-error>
      </mat-form-field>

      <!-- Action Buttons -->
      <div class="form-actions">
        <button
          mat-raised-button
          color="primary"
          type="submit">
          <mat-icon>save</mat-icon>
          {{ submitButtonText }}
        </button>
        <button
          mat-button
          type="button"
          (click)="onCancel()">
          <mat-icon>cancel</mat-icon>
          Cancel
        </button>
      </div>
    </form>
  </mat-card-content>
</mat-card>
